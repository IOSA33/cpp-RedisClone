cmake_minimum_required(VERSION 3.10)
project(redisIO VERSION 0.1)

set(CMAKE_CXX_STANDARD 23)
set(CMAKE_CXX_STANDARD_REQUIRED True)

# Downloading wepoll.c from github
include(FetchContent)
FetchContent_Declare(
  wepoll
  GIT_REPOSITORY https://github.com/piscisaureus/wepoll.git
  GIT_TAG        0598a791bf9cbbf480793d778930fc635b044980 # release 1.5.8
)

FetchContent_MakeAvailable(wepoll)
add_library(
    wepoll_lib STATIC
    ${wepoll_SOURCE_DIR}/wepoll.c
    ${CMAKE_CURRENT_SOURCE_DIR}/Include/wepoll.h
)

target_include_directories(wepoll_lib PUBLIC ${CMAKE_CURRENT_SOURCE_DIR}/Include)
target_link_libraries(wepoll_lib PUBLIC ws2_32)

# g++ main.cpp Redis.cpp Logger.cpp Network/Server.cpp -lws2_32 -o app

add_executable(app main.cpp
                   Redis.cpp
                   Logger.cpp
                   Network/Server.cpp)

target_link_libraries(app wepoll_lib)

